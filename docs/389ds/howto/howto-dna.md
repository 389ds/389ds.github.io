---
title: "Howto:DNA"
---

# DNA Examples
--------------

Using DNA to auto-generate uidNumber and gidNumber
--------------------------------------------------

By way of some background, it is worth noting that my basic requirement was simply to have a centralized back-end for authenticating SSH logins to the various machines in our park. The actual numerical values for the UID and GID fields did not need to be the same, they simply needed to be both extant and unique for each user, with the further caveat that they should not collide with any existing values that might be defined locally on the machines. This is a very basic set of requirements, so it is an excellent starting point for our example. The first step is to activate the DNA plug-in via the console :

    [TAB] Servers and Applications
     Domain -> Server -> Server Group -> Directory Server
     [SECTION] Configuration
      Server -> Plug-ins -> Distributed Numeric Assignment
       [X] Enable plug-in
       Save

The Directory Server needs to be restarted in order for the activation to take effect. This can either be done via the console, or via the command-line as normal. The next step is to define how DNA will interact with new user data ; this is different from configuring the plug-in itself, in that we will be setting up a layer in between the plug-in and the user data that will allow certain values to be generated automatically (which is, of course, the end goal of this exercise). Consider the following two LDIF snippets :

    # uids
    dn: cn=UID numbers,cn=Distributed Numeric Assignment Plugin,cn=plugins,cn=config
    objectClass: top
    objectClass: extensibleObject
    cn: UID numbers
    dnatype: uidNumber
    dnamagicregen: 99999
    dnafilter: (objectclass=posixAccount)
    dnascope: dc=example,dc=com
    dnanextvalue: 1000

    # gids
    dn: cn=GID numbers,cn=Distributed Numeric Assignment Plugin,cn=plugins,cn=config
    objectClass: top
    objectClass: extensibleObject
    cn: GID numbers
    dnatype: gidNumber
    dnamagicregen: 99999
    dnafilter: (|(objectclass=posixAccount)(objectclass=posixGroup))
    dnascope: dc=example,dc=com
    dnanextvalue: 1000

As you can see, they are nearly identical. This configuration activates the DNA magic-number functionality for the UID and GID fields as shown in the Posix attributes section of the console, though the values used may require further explanation. The only particular requirement for the magic number (specified by the **dnamagicregen** field) is that it be a value that cannot occur naturally, which is to say a value that would not be generated by the DNA plug-in, nor set manually at any time. The default value is **0**, but since this is clearly a number with meaning on the average Posix system, i would recommend a suitably large number that is unlikely to ever be used, such as **99999**. Non-numerical values can technically be used too ; however, these will not be acceptable to the console, so unless you're using a third-party interface (or doing everything from the commandline), a numerical value must be used.

The **dnanextvalue** field functionally indicates where the count will start from. As noted previously, in order to avoid collisions with existing local entries on the various machines, i chose a start point of **1000**, which was more than acceptable in my environment. Once these two snippets are integrated via the commandline, simply re-start the Directory Server (again), and you're good to go From now on, any time that a new user is created with the value **99999** entered into either (or both) of the UID and GID Posix fields, DNA will automatically generate real values as appropriate.

Hope that helps - enjoy !

